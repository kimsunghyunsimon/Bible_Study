import json
import urllib.request
import ssl

# 1. íŒŒì¼ ì´ë¦„
OUTPUT_FILE = 'bible_refs.json'

# 2. ì›ë³¸ ë°ì´í„° (ì—¬ê¸°ì— ì›ë˜ í…ìŠ¤íŠ¸ ì—†ì´ ì£¼ì†Œë§Œ ë“¤ì–´ìˆìŠµë‹ˆë‹¤)
URL = "https://raw.githubusercontent.com/scrollmapper/bible_databases/master/cross_references.json"

# ë°±ì—… URL (ë§Œì•½ ìœ„ ì£¼ì†Œê°€ ì•ˆ ë˜ë©´ ì´ê±¸ë¡œ êµì²´í•˜ì„¸ìš”)
# URL = "https://raw.githubusercontent.com/bephrem1/bible-cross-reference-json/master/cross_references.json"

# 3. í•œê¸€ ë³€í™˜í‘œ
ENG_TO_KOR = {
    "Genesis": "ì°½ì„¸ê¸°", "Exodus": "ì¶œì• êµ½ê¸°", "Leviticus": "ë ˆìœ„ê¸°", "Numbers": "ë¯¼ìˆ˜ê¸°", "Deuteronomy": "ì‹ ëª…ê¸°",
    "Joshua": "ì—¬í˜¸ìˆ˜ì•„", "Judges": "ì‚¬ì‚¬ê¸°", "Ruth": "ë£»ê¸°", "1 Samuel": "ì‚¬ë¬´ì—˜ìƒ", "2 Samuel": "ì‚¬ë¬´ì—˜í•˜",
    "1 Kings": "ì—´ì™•ê¸°ìƒ", "2 Kings": "ì—´ì™•ê¸°í•˜", "1 Chronicles": "ì—­ëŒ€ìƒ", "2 Chronicles": "ì—­ëŒ€í•˜", "Ezra": "ì—ìŠ¤ë¼",
    "Nehemiah": "ëŠí—¤ë¯¸ì•¼", "Esther": "ì—ìŠ¤ë”", "Job": "ìš¥ê¸°", "Psalms": "ì‹œí¸", "Proverbs": "ì ì–¸",
    "Ecclesiastes": "ì „ë„ì„œ", "Song of Solomon": "ì•„ê°€", "Isaiah": "ì´ì‚¬ì•¼", "Jeremiah": "ì˜ˆë ˆë¯¸ì•¼", "Lamentations": "ì˜ˆë ˆë¯¸ì•¼ì• ê°€",
    "Ezekiel": "ì—ìŠ¤ê²”", "Daniel": "ë‹¤ë‹ˆì—˜", "Hosea": "í˜¸ì„¸ì•„", "Joel": "ìš”ì—˜", "Amos": "ì•„ëª¨ìŠ¤",
    "Obadiah": "ì˜¤ë°”ëŒœ", "Jonah": "ìš”ë‚˜", "Micah": "ë¯¸ê°€", "Nahum": "ë‚˜í›”", "Habakkuk": "í•˜ë°•êµ­",
    "Zephaniah": "ìŠ¤ë°”ëƒ", "Haggai": "í•™ê°œ", "Zechariah": "ìŠ¤ê°€ë´", "Malachi": "ë§ë¼ê¸°",
    "Matthew": "ë§ˆíƒœë³µìŒ", "Mark": "ë§ˆê°€ë³µìŒ", "Luke": "ëˆ„ê°€ë³µìŒ", "John": "ìš”í•œë³µìŒ", "Acts": "ì‚¬ë„í–‰ì „",
    "Romans": "ë¡œë§ˆì„œ", "1 Corinthians": "ê³ ë¦°ë„ì „ì„œ", "2 Corinthians": "ê³ ë¦°ë„í›„ì„œ", "Galatians": "ê°ˆë¼ë””ì•„ì„œ", "Ephesians": "ì—ë² ì†Œì„œ",
    "Philippians": "ë¹Œë¦½ë³´ì„œ", "Colossians": "ê³¨ë¡œìƒˆì„œ", "1 Thessalonians": "ë°ì‚´ë¡œë‹ˆê°€ì „ì„œ", "2 Thessalonians": "ë°ì‚´ë¡œë‹ˆê°€í›„ì„œ",
    "1 Timothy": "ë””ëª¨ë°ì „ì„œ", "2 Timothy": "ë””ëª¨ë°í›„ì„œ", "Titus": "ë””ë„ì„œ", "Philemon": "ë¹Œë ˆëª¬ì„œ", "Hebrews": "íˆë¸Œë¦¬ì„œ",
    "James": "ì•¼ê³ ë³´ì„œ", "1 Peter": "ë² ë“œë¡œì „ì„œ", "2 Peter": "ë² ë“œë¡œí›„ì„œ", "1 John": "ìš”í•œì¼ì„œ", "2 John": "ìš”í•œì´ì„œ",
    "3 John": "ìš”í•œì‚¼ì„œ", "Jude": "ìœ ë‹¤ì„œ", "Revelation": "ìš”í•œê³„ì‹œë¡"
}

def create_link_data():
    print("ğŸš€ ì—°ê²° ë°ì´í„°ë§Œ ì¶”ì¶œí•©ë‹ˆë‹¤...")
    
    ctx = ssl.create_default_context()
    ctx.check_hostname = False
    ctx.verify_mode = ssl.CERT_NONE
    
    try:
        # ë‹¤ìš´ë¡œë“œ
        with urllib.request.urlopen(URL, context=ctx) as response:
            data = json.loads(response.read().decode('utf-8'))
        
        new_data = {}
        print("ğŸ”„ í•œê¸€ ì£¼ì†Œë¡œ ë³€í™˜ ì¤‘...")

        for key, refs in data.items():
            # key: "Genesis 1:1"
            # refs: ["John 1:1", "Hebrews 11:3"] (ë‚´ìš© ì—†ìŒ, ì£¼ì†Œë§Œ ìˆìŒ)
            
            # 1. í‚¤(Key) í•œê¸€ ë³€í™˜
            kor_key = key
            for eng, kor in ENG_TO_KOR.items():
                if key.startswith(eng + " "):
                    kor_key = key.replace(eng, kor, 1)
                    break
            
            # 2. ê°’(Value) ë¦¬ìŠ¤íŠ¸ í•œê¸€ ë³€í™˜
            kor_refs = []
            for r in refs:
                kor_ref = r
                for eng, kor in ENG_TO_KOR.items():
                    if eng in r:
                        kor_ref = r.replace(eng, kor)
                        break
                kor_refs.append(kor_ref) # ì£¼ì†Œë§Œ ë¦¬ìŠ¤íŠ¸ì— ë‹´ìŒ
            
            new_data[kor_key] = kor_refs
        
        # ì €ì¥
        with open(OUTPUT_FILE, 'w', encoding='utf-8') as f:
            json.dump(new_data, f, ensure_ascii=False, indent=2)

        print(f"ğŸ‰ ì„±ê³µ! 'bible_refs.json'ì´ ì•„ì£¼ ê°€ë³ê²Œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.")

    except Exception as e:
        print(f"âŒ ì˜¤ë¥˜: {e}")

if __name__ == "__main__":
    create_link_data()